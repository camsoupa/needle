var fs = require('fs');
var sweet = require('../git/sweet.js-fork/build/lib/sweet.js');
// var sweet = require('sweet.js');
var test  = fs.readFileSync('./test.js', 'utf8');
var mod;

// console.time('stxcase');
// sweet.loadModule('');
// console.timeEnd('stxcase');

// console.time('sparkler');
// mod = sweet.loadNodeModule('./', './macros');
// console.timeEnd('sparkler');

// console.time('compile');
// sweet.expand(test, [mod]);
// console.timeEnd('compile');

var Promise = require('bluebird');

console.time('stxcase');
sweet.loadModule('')
  .then(function(m) {
    console.timeEnd('stxcase');
  })
  .then(function() {
    console.time('sparkler');
    return sweet.loadNodeModule('./', './macros');
  })
  .then(function(m) {
    console.timeEnd('sparkler');
    return m;
  })
  .then(function(m) {
    console.time('compile');
    return sweet.expand(test, [Promise.resolve(m)]);
  })
  .then(function(res) {
    console.timeEnd('compile');
  });
